{% extends "header.html" %}
{% block title %}Undergrad Lab Resources Portal{% endblock %}
{% block content %}
<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
      <div class="col-lg-8 col-md-10">
        <h4>Admin Portal</h4>
        <div class="card mt-3 mb-3">
          <div class="card">
              <div class="card-header">
                <nav>
                  <div class="nav nav-tabs card-header-tabs" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-map-tab" data-toggle="tab" href="#nav-map" role="tab" aria-controls="nav-map" aria-selected="true">Map</a>
                    <a class="nav-item nav-link" id="nav-tasks-tab" data-toggle="tab" href="#nav-tasks" role="tab" aria-controls="nav-tasks" aria-selected="false">Lab Stats</a>
                  </div>
                </nav>
              </div>
              <div class="card-body">
                <div class="tab-content" id="nav-tabContent">
                  <div class="tab-pane fade show active" id="nav-map" role="tabpanel" aria-labelledby="nav-map-tab">
                    <!-- Content for Map tab -->
                    <p>Here is a map of the classroom, the red arrow will help you find your designated seating.</p>
                    <!-- Placeholder for map image -->
                    <img src="../static/img/1-b9b229913a.jpg" alt="Map" class="img-fluid">
                  </div>

                  <div class="tab-pane fade" id="nav-tasks" role="tabpanel" aria-labelledby="nav-tasks-tab">
                    <!-- Content for Tasks tab -->
                    <p>In here, the progress of the students in the lab will be recorded, as well as resources that has been used by the students performing the relevent tasks</p>
                    <!-- Placeholder for tasks content or image -->
                    <div>
                        <canvas id="accessChart"></canvas>
                    </div>                    
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function () {
        fetchData();
        setInterval(fetchData, 5000);
    });
    function fetchData() {
        fetch('/get-access-counts')
            .then(response => response.json())
            .then(data => {
                const ctx = document.getElementById('accessChart').getContext('2d');
                const accessChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.map(item => item.page_name),
                        datasets: [{
                            label: 'Count',
                            data: data.map(item => item.view_count),
                            backgroundColor: 'rgba(0, 123, 255, 0.5)',
                            borderColor: 'rgba(0, 123, 255, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                const ctx2 = document.getElementById('accessChart2').getContext('2d');
                const footprintChart2 = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: data.map(item => item.page_name),
                        datasets: [{
                            label: 'Page Access Counts',
                            data: data.map(item => item.view_count),
                            backgroundColor: 'rgba(0, 123, 255, 0.5)',
                            borderColor: 'rgba(0, 123, 255, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    }
  </script>



{% endblock %}